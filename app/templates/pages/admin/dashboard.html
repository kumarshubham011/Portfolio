{% extends "base.html" %}
<!--
=============================================================================
ADMIN DASHBOARD TEMPLATE
=============================================================================
Purpose: Overview of all content with quick actions.

Shows:
- Statistics (post counts, project counts)
- Recent posts with edit links
- All projects with edit links
- Quick create buttons
=============================================================================
-->

{% block title %}Admin Dashboard — {{ site_name }}{% endblock %}

{% block content %}
<div class="container container--wide">
    <!-- Dashboard Header -->
    <header class="admin-header">
        <h1>Dashboard</h1>
        <a href="/auth/logout" class="btn btn-secondary">Log Out</a>
    </header>

    <!-- Statistics Cards -->
    <section class="admin-stats">
        <div class="stat-card">
            <div class="stat-number">{{ total_posts }}</div>
            <div class="stat-label">Total Posts</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">{{ published_posts }}</div>
            <div class="stat-label">Published</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">{{ draft_posts }}</div>
            <div class="stat-label">Drafts</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">{{ total_projects }}</div>
            <div class="stat-label">Projects</div>
        </div>
    </section>

    <!-- Blog Posts Section -->
    <section class="admin-section">
        <div class="admin-section-header">
            <h2>Blog Posts</h2>
            <a href="/admin/posts/new" class="btn btn-primary">New Post</a>
        </div>
        
        {% if recent_posts %}
        <div>
            {% for post in recent_posts %}
            <article class="post-card">
                <h3>
                    <a href="/blog/{{ post.slug }}">{{ post.title }}</a>
                    {% if not post.published %}
                    <span class="post-status post-status--draft">Draft</span>
                    {% else %}
                    <span class="post-status post-status--published">Published</span>
                    {% endif %}
                </h3>
                <p class="post-meta">
                    Created: {{ post.created_at.strftime('%B %d, %Y') }}
                    {% if post.updated_at != post.created_at %}
                    · Updated: {{ post.updated_at.strftime('%B %d, %Y') }}
                    {% endif %}
                </p>
                <div class="btn-group" style="margin-top: var(--space-3);">
                    <a href="/admin/posts/{{ post.id }}/edit" class="btn btn-secondary">Edit</a>
                    <a href="/blog/{{ post.slug }}" class="btn btn-secondary">View</a>
                    <form action="/admin/posts/{{ post.id }}/delete" method="POST" style="display: inline;">
                        <button 
                            type="submit" 
                            class="btn btn-danger" 
                            data-confirm="Are you sure you want to delete '{{ post.title }}'?"
                        >
                            Delete
                        </button>
                    </form>
                </div>
            </article>
            {% endfor %}
        </div>
        {% else %}
        <p class="text-muted">No posts yet. <a href="/admin/posts/new">Create your first post!</a></p>
        {% endif %}
    </section>

    <!-- Projects Section -->
    <section class="admin-section">
        <div class="admin-section-header">
            <h2>Projects</h2>
            <a href="/admin/projects/new" class="btn btn-primary">New Project</a>
        </div>
        
        {% if projects %}
        <div>
            {% for project in projects %}
            <article class="project-card">
                <h3>
                    {{ project.title }}
                    {% if project.featured %}
                    <span class="post-status post-status--published">Featured</span>
                    {% endif %}
                </h3>
                <p class="text-muted">{{ project.tech_stack }}</p>
                <div class="btn-group" style="margin-top: var(--space-3);">
                    <a href="/admin/projects/{{ project.id }}/edit" class="btn btn-secondary">Edit</a>
                    {% if project.url %}
                    <a href="{{ project.url }}" target="_blank" class="btn btn-secondary">View Live</a>
                    {% endif %}
                    <form action="/admin/projects/{{ project.id }}/delete" method="POST" style="display: inline;">
                        <button 
                            type="submit" 
                            class="btn btn-danger" 
                            data-confirm="Are you sure you want to delete '{{ project.title }}'?"
                        >
                            Delete
                        </button>
                    </form>
                </div>
            </article>
            {% endfor %}
        </div>
        {% else %}
        <p class="text-muted">No projects yet. <a href="/admin/projects/new">Add your first project!</a></p>
        {% endif %}
    </section>
</div>
{% endblock %}
