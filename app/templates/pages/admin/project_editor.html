{% extends "base.html" %}
<!--
=============================================================================
PROJECT EDITOR TEMPLATE
=============================================================================
Purpose: Create/edit portfolio projects.

Features:
- Title input
- Markdown description
- Tech stack input
- URL fields (live, github, image)
- Featured toggle
- Display order
=============================================================================
-->

{% block title %}{{ action }} Project — {{ site_name }}{% endblock %}

{% block content %}
<div class="container">
    <header class="admin-header">
        <h1>{{ action }} Project</h1>
        <a href="/admin" class="btn btn-secondary">← Back to Dashboard</a>
    </header>

    {% if success %}
    <div class="alert alert-success">
        Project saved successfully!
    </div>
    {% endif %}

    {% if error %}
    <div class="alert alert-error">
        {{ error }}
    </div>
    {% endif %}

    <form 
        method="POST" 
        action="{% if project %}/admin/projects/{{ project.id }}{% else %}/admin/projects{% endif %}"
    >
        <!-- Title -->
        <div class="form-group">
            <label for="title" class="form-label">Project Title</label>
            <input 
                type="text" 
                id="title" 
                name="title" 
                class="form-input"
                value="{{ project.title if project else '' }}"
                required
                placeholder="My Awesome Project"
            >
        </div>

        <!-- Description (Markdown) -->
        <div class="form-group">
            <label for="description" class="form-label">Description (Markdown)</label>
            <textarea 
                id="description" 
                name="description" 
                class="form-textarea"
                required
                placeholder="Describe your project...

## Overview
What does this project do?

## Features
- Feature 1
- Feature 2

## Challenges
What problems did you solve?
"
            >{{ project.description if project else '' }}</textarea>
        </div>

        <!-- Tech Stack -->
        <div class="form-group">
            <label for="tech_stack" class="form-label">Tech Stack</label>
            <input 
                type="text" 
                id="tech_stack" 
                name="tech_stack" 
                class="form-input"
                value="{{ project.tech_stack if project else '' }}"
                required
                placeholder="Python, FastAPI, SQLite, HTML, CSS"
            >
            <p class="form-hint">
                Comma-separated list of technologies used.
            </p>
        </div>

        <!-- URLs -->
        <div class="form-group">
            <label for="url" class="form-label">Live URL (Optional)</label>
            <input 
                type="url" 
                id="url" 
                name="url" 
                class="form-input"
                value="{{ project.url if project else '' }}"
                placeholder="https://myproject.com"
            >
        </div>

        <div class="form-group">
            <label for="github_url" class="form-label">GitHub URL (Optional)</label>
            <input 
                type="url" 
                id="github_url" 
                name="github_url" 
                class="form-input"
                value="{{ project.github_url if project else '' }}"
                placeholder="https://github.com/username/project"
            >
        </div>

        <div class="form-group">
            <label for="image_url" class="form-label">Preview Image URL (Optional)</label>
            <input 
                type="url" 
                id="image_url" 
                name="image_url" 
                class="form-input"
                value="{{ project.image_url if project else '' }}"
                placeholder="https://example.com/screenshot.png"
            >
        </div>

        <!-- Featured & Order -->
        <div class="form-group">
            <label class="form-checkbox">
                <input 
                    type="checkbox" 
                    name="featured" 
                    {% if project and project.featured %}checked{% endif %}
                >
                <span>Featured (show on homepage)</span>
            </label>
        </div>

        <div class="form-group">
            <label for="order" class="form-label">Display Order</label>
            <input 
                type="number" 
                id="order" 
                name="order" 
                class="form-input"
                value="{{ project.order if project else 0 }}"
                min="0"
                style="max-width: 100px;"
            >
            <p class="form-hint">
                Lower numbers appear first. Use 0, 1, 2, etc.
            </p>
        </div>

        <!-- Actions -->
        <div class="btn-group">
            <button type="submit" class="btn btn-primary">
                {{ 'Update' if project else 'Create' }} Project
            </button>
            {% if project %}
            <a href="/projects" class="btn btn-secondary">
                View on Site
            </a>
            {% endif %}
            <a href="/admin" class="btn btn-secondary">Cancel</a>
        </div>
    </form>

    {% if project %}
    <!-- Danger Zone -->
    <section class="section mt-8" style="border-top: 1px solid var(--color-border); padding-top: var(--space-8);">
        <h3 style="color: var(--color-accent);">Danger Zone</h3>
        <p class="text-muted mb-4">
            Deleting a project is permanent and cannot be undone.
        </p>
        <form action="/admin/projects/{{ project.id }}/delete" method="POST">
            <button 
                type="submit" 
                class="btn btn-danger"
                data-confirm="Are you sure you want to delete '{{ project.title }}'? This cannot be undone."
            >
                Delete This Project
            </button>
        </form>
    </section>
    {% endif %}
</div>
{% endblock %}
